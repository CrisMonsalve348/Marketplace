extends ../../layout/admin.pug

block content
  div(class="mx-auto max-w-7xl px-4 mt-6")
    div(class="flex items-center justify-between mb-6")
      h1(class="text-3xl font-bold text-gray-900") GestiÃ³n de Pedidos
      a(href="/admin/pedidos" class="inline-flex items-center px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-md transition") 
        | Actualizar
    
    // Filtro por estado
    div(class="bg-white shadow rounded-lg p-4 mb-6")
      form(action="/admin/pedidos" method="GET" class="flex flex-wrap items-center gap-4")
        label(class="text-sm font-medium text-gray-700") Filtrar por estado:
        select(name="estado" class="appearance-none block px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm")
          option(value="todos" selected=filtroEstado==='todos') Todos
          each estado in estadosDisponibles
            option(value=estado.valor selected=filtroEstado===estado.valor)= estado.label
        button(type="submit" class="inline-flex items-center px-4 py-2 border border-indigo-300 rounded-md shadow-sm text-sm font-medium text-indigo-700 bg-white hover:bg-indigo-50 transition") Filtrar

    // Tabla de pedidos
    if pedidos.length > 0
      div(class="bg-white shadow rounded-lg overflow-hidden")
        table(class="min-w-full divide-y divide-gray-200")
          thead(class="bg-gray-50")
            tr
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") ID
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Cliente
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Email
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Total
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Estado
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Fecha
              th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Acciones
          tbody(class="bg-white divide-y divide-gray-200")
            each pedido in pedidos
              tr(class="hover:bg-gray-50 transition")
                td(class="px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900")= `#${pedido.id}`
                td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-900")= pedido.usuario.nombre
                td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")= pedido.usuario.email
                td(class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900") $#{parseFloat(pedido.total).toFixed(2)}
                td(class="px-6 py-4 whitespace-nowrap text-sm")
                  - const estadoClases = pedido.estado === 'pendiente' ? 'bg-yellow-100 text-yellow-800' : pedido.estado === 'pagado' ? 'bg-blue-100 text-blue-800' : pedido.estado === 'enviado' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                  span(class=`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${estadoClases}`)
                    case pedido.estado
                      when 'pendiente'
                        | Pendiente
                      when 'pagado'
                        | Pagado
                      when 'enviado'
                        | Enviado
                      when 'cancelado'
                        | Cancelado
                td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")= new Date(pedido.fecha_creacion).toLocaleDateString('es-CO')
                td(class="px-6 py-4 whitespace-nowrap text-sm font-medium")
                  a(href=`/admin/pedidos/${pedido.id}` class="text-indigo-600 hover:text-indigo-900 font-medium") Ver Detalle
    
    else
      div(class="bg-blue-50 border border-blue-200 rounded-lg p-6 text-center")
        p(class="text-blue-800") No hay pedidos para mostrar.

block scripts
  script.
    // Placeholder para scripts futuros
